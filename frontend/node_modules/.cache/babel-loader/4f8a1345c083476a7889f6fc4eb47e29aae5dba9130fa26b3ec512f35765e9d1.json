{"ast":null,"code":"var _jsxFileName = \"D:\\\\Sem 7\\\\Despro 2\\\\Project\\\\Project V.1\\\\frontend\\\\src\\\\components\\\\Dashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useContext } from 'react';\nimport axios from 'axios';\nimport jwt_decode from \"jwt-decode\";\nimport { UserContext } from '../context/User';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Dashboard = () => {\n  _s();\n  const [name, setName] = useState('');\n  const [id, setId] = useState('');\n  const [token, setToken] = useState('');\n  const [expiredToken, setExpiredToken] = useState('');\n  const [daftarAlat, setDaftarAlat] = useState([]);\n  const [status, setStatus] = useState([]);\n  const navigate = useNavigate();\n  // const msg = useContext(UserContext);\n  const {\n    user,\n    setUser\n  } = useContext(UserContext);\n  useEffect(() => {\n    getAlat();\n    refreshToken();\n  }, []);\n  const refreshToken = async () => {\n    try {\n      const response = await axios.get('http://localhost:5000/token');\n      setToken(response.data.accessToken);\n      const decoded = jwt_decode(response.data.accessToken);\n      setName(decoded.name);\n      setId(decoded.idPeminjam);\n      setExpiredToken(decoded.exp);\n      setUser({\n        name: decoded.name,\n        email: decoded.email,\n        npm: decoded.npm,\n        denda: decoded.denda\n      });\n    } catch (error) {\n      if (error.response) {\n        navigate('/');\n      }\n    }\n  };\n  const axiosJWT = axios.create();\n  axiosJWT.interceptors.request.use(async config => {\n    const currentDate = new Date();\n    if (expiredToken * 1000 < currentDate.getTime()) {\n      const response = await axios.get(\"http://localhost:5000/token\");\n      config.headers.Authorization = `Bearer ${response.data.accessToken}`;\n      setToken(response.data.accessToken);\n      const decoded = jwt_decode(response.data.accessToken);\n      setName(decoded.name);\n      setId(decoded.idPeminjam);\n      setExpiredToken(decoded.exp);\n      setUser(decoded.idPeminjam);\n    }\n    return config;\n  }, error => {\n    return Promise.reject(error);\n  });\n  const getAlat = async () => {\n    try {\n      const response = await axios.get('http://localhost:5000/alat');\n      // console.log(response.data);\n      const statusList = response.data.map((data, i) => {\n        if (data.statusAlat === 0) {\n          return \"Tersedia\";\n        } else {\n          return \"Dipinjam\";\n        }\n      });\n      setStatus(statusList);\n      setDaftarAlat(response.data);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  const Booking = (e, namaAlat, idAlat) => {\n    e.preventDefault();\n    try {\n      // await axios.post('http://localhost:5000/peminjam',{\n      //     name:name,\n      //     email:email,\n      //     password:password,\n      //     confPassword: confPassword\n      // });\n      navigate(\"/booking\", {\n        state: {\n          namaAlat: namaAlat,\n          idAlat: idAlat,\n          idPeminjam: id\n        }\n      });\n    } catch (error) {\n      if (error.response) {\n        console.log(error.response.data.msg);\n      }\n    }\n  };\n\n  // const getUsers = async() => {\n  //   const response = await axiosJWT.get(\"http://localhost:5000/peminjam\",{\n  //     headers:{\n  //       Authorization: `Bearer ${token}`\n  //     }\n  //   });\n  //   console.log(response.data);\n  // }\n\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container mt-5\",\n      children: /*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"title is-5 m-4\",\n        children: [\"Welcome Back to E-Lab, \", name, \", id:\", user, \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container mt-5\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"columns is-multiline\",\n        children: daftarAlat.map((card, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"column is-one-quarter-desktop is-half-tablet\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"box card\",\n            children: [/*#__PURE__*/_jsxDEV(\"figure\", {\n              className: \"image is-1by1\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: card.url,\n                alt: \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 120,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"has-text-centered\",\n              children: card.namaAlat\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"has-text-centered\",\n              children: [\"Status: \", status[i], \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: e => {\n                Booking(e, card.namaAlat, card.id);\n              },\n              className: \"button is-primary is-responsive is-fullwidth\",\n              children: \"Book\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 37\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 29\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 11\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 5\n  }, this);\n};\n_s(Dashboard, \"pT6C7Y7cNWMmIFJVn58qLcPnrCo=\", false, function () {\n  return [useNavigate];\n});\n_c = Dashboard;\nexport default Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useState","useEffect","useContext","axios","jwt_decode","UserContext","useNavigate","Dashboard","name","setName","id","setId","token","setToken","expiredToken","setExpiredToken","daftarAlat","setDaftarAlat","status","setStatus","navigate","user","setUser","getAlat","refreshToken","response","get","data","accessToken","decoded","idPeminjam","exp","email","npm","denda","error","axiosJWT","create","interceptors","request","use","config","currentDate","Date","getTime","headers","Authorization","Promise","reject","statusList","map","i","statusAlat","console","log","Booking","e","namaAlat","idAlat","preventDefault","state","msg","card","url"],"sources":["D:/Sem 7/Despro 2/Project/Project V.1/frontend/src/components/Dashboard.js"],"sourcesContent":["import React, { useState,useEffect, useContext} from 'react';\r\nimport axios from 'axios';\r\nimport jwt_decode from \"jwt-decode\";\r\nimport { UserContext } from '../context/User';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst Dashboard = () => {\r\n  const [name,setName] = useState('');\r\n  const [id,setId] = useState('');\r\n  const [token,setToken] = useState('');\r\n  const [expiredToken,setExpiredToken] = useState('');\r\n  const [daftarAlat,setDaftarAlat] = useState([]);\r\n  const [status,setStatus] = useState([]);\r\n  const navigate = useNavigate();\r\n  // const msg = useContext(UserContext);\r\n  const { user, setUser } = useContext(UserContext);\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    getAlat();\r\n    refreshToken();\r\n  },[]);\r\n\r\n\r\n  const refreshToken = async()=>{\r\n    try{\r\n      const response = await axios.get('http://localhost:5000/token');\r\n      setToken(response.data.accessToken);\r\n      const decoded = jwt_decode(response.data.accessToken);\r\n      setName(decoded.name);\r\n      setId(decoded.idPeminjam);\r\n      setExpiredToken(decoded.exp);\r\n\r\n      setUser({name:decoded.name, email:decoded.email,npm:decoded.npm,denda:decoded.denda});\r\n\r\n\r\n    } catch(error){\r\n      if(error.response){\r\n        navigate('/');\r\n      }\r\n    }\r\n  }\r\n\r\n  const axiosJWT = axios.create();\r\n\r\n  axiosJWT.interceptors.request.use(async(config) => {\r\n    const currentDate = new Date();\r\n    if(expiredToken*1000 < currentDate.getTime()) {\r\n      const response = await axios.get(\"http://localhost:5000/token\");\r\n      config.headers.Authorization = `Bearer ${response.data.accessToken}`;\r\n      setToken(response.data.accessToken);\r\n      const decoded = jwt_decode(response.data.accessToken);\r\n      setName(decoded.name);\r\n      setId(decoded.idPeminjam);\r\n      setExpiredToken(decoded.exp); \r\n      setUser(decoded.idPeminjam);\r\n    }\r\n    return config;\r\n  },(error) => {\r\n    return Promise.reject(error);\r\n  })\r\n\r\n  const getAlat = async() => {\r\n      try{\r\n          const response = await axios.get('http://localhost:5000/alat');\r\n          // console.log(response.data);\r\n          const statusList = response.data.map((data,i)=>{\r\n              if(data.statusAlat === 0) {\r\n                  return \"Tersedia\";\r\n              } else {\r\n                  return \"Dipinjam\";\r\n              }\r\n          })\r\n          setStatus(statusList);\r\n          setDaftarAlat(response.data);\r\n      } catch(error) {\r\n          console.log(error);\r\n      }\r\n  } \r\n\r\n  const Booking = (e,namaAlat, idAlat)=>{\r\n    e.preventDefault();\r\n    try{\r\n        // await axios.post('http://localhost:5000/peminjam',{\r\n        //     name:name,\r\n        //     email:email,\r\n        //     password:password,\r\n        //     confPassword: confPassword\r\n        // });\r\n        navigate(\"/booking\",{ state: { namaAlat: namaAlat, idAlat:idAlat, idPeminjam: id} });\r\n    } catch (error){\r\n        if(error.response){\r\n            console.log(error.response.data.msg);\r\n        }\r\n    }\r\n  }\r\n\r\n  // const getUsers = async() => {\r\n  //   const response = await axiosJWT.get(\"http://localhost:5000/peminjam\",{\r\n  //     headers:{\r\n  //       Authorization: `Bearer ${token}`\r\n  //     }\r\n  //   });\r\n  //   console.log(response.data);\r\n  // }\r\n\r\n  return (\r\n    <section>\r\n          <div className='container mt-5'>\r\n            <h1 className=\"title is-5 m-4\">Welcome Back to E-Lab, {name}, id:{user} </h1>\r\n          </div>\r\n          <div className='container mt-5'>\r\n            <div className=\"columns is-multiline\">\r\n                    {\r\n                        daftarAlat.map((card,i)=>(\r\n                            <div className=\"column is-one-quarter-desktop is-half-tablet\">\r\n                                <div key={i} className=\"box card\" >\r\n                                    <figure className='image is-1by1'>\r\n                                        <img src={card.url} alt=\"\" />\r\n                                    </figure>\r\n                                    <h3 className='has-text-centered'>{card.namaAlat}</h3>\r\n                                    <p className='has-text-centered'>Status: {status[i]} </p>\r\n                                    <button onClick={(e)=>{\r\n                                        Booking(e,card.namaAlat,card.id)\r\n                                    }} className='button is-primary is-responsive is-fullwidth'>Book</button>\r\n                                </div>\r\n                            </div>\r\n                        ))\r\n                    }\r\n            </div>\r\n        </div>\r\n    </section>\r\n\r\n    \r\n  )\r\n}\r\n\r\nexport default Dashboard"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}